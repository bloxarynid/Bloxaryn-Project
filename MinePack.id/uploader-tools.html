<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>MinePack Manager - Upload & Manage Addons</title>
    <link rel="icon" type="image/x-icon" href="https://avatars.githubusercontent.com/u/248623682?v=4">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;700&amp;display=swap" rel="stylesheet"/>
    <style>
        :root {
            --gradient-colors: linear-gradient(270deg, #05121a, #062538, #0b5c86, #105274, #105274, #0d3b5b, #062538, #05121a);
            --text-color: #fff;
            --glass-bg: rgba(255, 255, 255, 0.07);
            --glass-border: rgba(255, 255, 255, 0.15);
            --button-bg: rgba(255, 255, 255, 0.1);
            --button-hover: rgba(255, 255, 255, 0.2);
            --accent-color: #73889f;
            --accent-hover: #384758;
            --success-color: #729669;
            --success-hover: #394237;
            --danger-color: #e74c3c;
            --danger-hover: #c0392b;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Rubik', sans-serif;
            background: linear-gradient(to bottom, #1a1a2e 0%, #16213e 100%);
            color: var(--text-color);
            overflow-x: hidden;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 12px rgba(255,255,255,0.3);
        }

        .subtitle {
            color: #aaa;
            font-size: 1.1em;
            margin-bottom: 30px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 12px 24px;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
            font-weight: 500;
        }

        .tab-button.active {
            background: var(--accent-color);
            border-color: var(--accent-color);
        }

        .tab-button:hover:not(.active) {
            background: var(--button-hover);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .upload-form {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #ddd;
        }

        .form-group input[type="text"],
        .form-group input[type="url"],
        .form-group input[type="number"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--glass-border);
            border-radius: 6px;
            color: var(--text-color);
            font-family: 'Rubik', sans-serif;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent-color);
            background: rgba(255, 255, 255, 0.12);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .input-with-button {
            display: flex;
            gap: 10px;
        }

        .input-with-button input {
            flex: 1;
        }

        .add-button {
            padding: 12px 20px;
            background: var(--accent-color);
            border: none;
            border-radius: 6px;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .add-button:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
        }

        .remove-button {
            padding: 12px 20px;
            background: var(--danger-color);
            border: none;
            border-radius: 6px;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .remove-button:hover {
            background: var(--danger-hover);
            transform: translateY(-2px);
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        .dynamic-list {
            margin-top: 10px;
        }

        .dynamic-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }

        .dynamic-item input {
            flex: 1;
        }

        .preview-section {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 30px;
            margin-top: 30px;
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .preview-header h2 {
            font-size: 1.5em;
        }

        .copy-button {
            padding: 10px 20px;
            background: var(--success-color);
            border: none;
            border-radius: 6px;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }

        .copy-button:hover {
            background: var(--success-hover);
            transform: translateY(-2px);
        }

        .copy-button.copied {
            background: #27ae60;
        }

        .code-container {
            position: relative;
        }

        .code-block {
            background: #1a1a1a;
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.5;
            max-height: 400px;
            overflow-y: auto;
        }

        .code-block pre {
            margin: 0;
            color: #f8f8f2;
        }

        .addons-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .addon-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .addon-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .addon-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .addon-icon {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            overflow: hidden;
            flex-shrink: 0;
        }

        .addon-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .addon-info {
            flex: 1;
        }

        .addon-title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text-color);
        }

        .addon-category {
            display: inline-block;
            padding: 4px 8px;
            background: rgba(115, 136, 159, 0.2);
            border-radius: 4px;
            font-size: 0.8em;
            color: var(--accent-color);
        }

        .addon-stats {
            display: flex;
            gap: 15px;
            margin-top: 10px;
            font-size: 0.9em;
            color: #aaa;
        }

        .addon-stat {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .addon-description {
            margin-top: 15px;
            color: #ccc;
            font-size: 0.9em;
            line-height: 1.5;
            max-height: 60px;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .addon-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .action-button {
            flex: 1;
            padding: 8px 15px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .edit-button {
            background: var(--accent-color);
            color: white;
        }

        .edit-button:hover {
            background: var(--accent-hover);
        }

        .delete-button {
            background: var(--danger-color);
            color: white;
        }

        .delete-button:hover {
            background: var(--danger-hover);
        }

        .submit-button {
            width: 100%;
            padding: 15px;
            background: var(--accent-color);
            border: none;
            border-radius: 8px;
            color: var(--text-color);
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .submit-button:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.4s ease, opacity 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            opacity: 0;
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .notification.success {
            background: rgba(46, 204, 113, 0.9);
        }

        .notification.error {
            background: rgba(231, 76, 60, 0.9);
        }

        .notification.info {
            background: rgba(52, 152, 219, 0.9);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #aaa;
        }

        .empty-state i {
            font-size: 3em;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 20px;
            }
            
            .form-row .form-group {
                width: 100%;
            }
            
            .addons-list {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab-button {
                width: 100%;
                text-align: center;
            }
        }
        
        .results-title {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.8em;
            color: var(--text-color);
        }
        
        #manageTab h2 {
            text-align: center;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-upload"></i>  MinePack</h1>
            <p class="subtitle">Upload dan Kelola Addons Minecraft Anda</p>
        </header>

        <div class="tabs">
            <button class="tab-button active" data-tab="upload">Upload Addon</button>
            <button class="tab-button" data-tab="manage">Kelola Addon</button>
            <button class="tab-button" data-tab="generate">Generate Script</button>
        </div>

        <div id="uploadTab" class="tab-content active">
            <form id="addonForm" class="upload-form">
                <div class="form-group">
                    <label for="addonTitle"><i class="fas fa-heading"></i> Nama Addon/Pack</label>
                    <input type="text" id="addonTitle" placeholder="Contoh: SweepNSlash v2.0.0" required>
                </div>

                <div class="form-group">
                    <label for="addonCategory"><i class="fas fa-tag"></i> Kategori</label>
                    <select id="addonCategory" required>
                        <option value="">Pilih kategori...</option>
                        <option value="addons">Addons</option>
                        <option value="maps">Maps/World</option>
                        <option value="mashups">Mashups</option>
                        <option value="textures">Textures</option>
                        <option value="skins">Skins</option>
                        <option value="modrinth">Mod</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="addonImage"><i class="fas fa-image"></i> URL Gambar/Icon</label>
                    <input type="url" id="addonImage" placeholder="https://example.com/image.jpg" required>
                </div>

                <div class="form-group">
                    <label for="addonLink"><i class="fas fa-link"></i> Link Download</label>
                    <input type="url" id="addonLink" placeholder="https://mediafire.com/file/..." required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="addonRating"><i class="fas fa-star"></i> Rating (0.0 - 5.0)</label>
                        <input type="number" id="addonRating" min="0" max="5" step="0.1" placeholder="4.2" required>
                    </div>
                    <div class="form-group">
                        <label for="addonDownloads"><i class="fas fa-download"></i> Jumlah Download</label>
                        <input type="number" id="addonDownloads" min="0" placeholder="5621" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="addonDescription"><i class="fas fa-align-left"></i> Deskripsi</label>
                    <textarea id="addonDescription" placeholder="Deskripsi lengkap tentang addon ini..." required></textarea>
                </div>

                <div class="form-group">
                    <label><i class="fas fa-file"></i> File (Nama dan Ukuran)</label>
                    <div id="filesContainer" class="dynamic-list">
                        <div class="dynamic-item">
                            <input type="text" class="fileName" placeholder="Nama file (contoh: SweepNSlash Pack)" required>
                            <input type="text" class="fileSize" placeholder="Ukuran (contoh: 2.5 MB)" required>
                            <button type="button" class="remove-button remove-file"><i class="fas fa-minus"></i></button>
                        </div>
                    </div>
                    <button type="button" id="addFileButton" class="add-button">
                        <i class="fas fa-plus"></i> Tambah File
                    </button>
                </div>

                <div class="form-group">
                    <label><i class="fas fa-images"></i> Gallery Images</label>
                    <div id="galleryContainer" class="dynamic-list">
                        <div class="dynamic-item">
                            <input type="url" class="galleryUrl" placeholder="https://example.com/gallery1.jpg" required>
                            <button type="button" class="remove-button remove-gallery"><i class="fas fa-minus"></i></button>
                        </div>
                    </div>
                    <button type="button" id="addGalleryButton" class="add-button">
                        <i class="fas fa-plus"></i> Tambah Gambar Gallery
                    </button>
                </div>

                <button type="submit" class="submit-button">
                    <i class="fas fa-save"></i> Simpan Addon
                </button>
            </form>
        </div>

        <div id="manageTab" class="tab-content">
            <div>
                <h2 class="results-title"><i class="fas fa-list"></i>  Addons Results</h2>
                <div id="addonsContainer" class="addons-list">
                    <div class="empty-state" id="emptyState">
                        <i class="fas fa-box-open"></i>
                        <h3>Belum ada addon</h3>
                        <p>Upload addon pertama Anda di tab "Upload Addon"</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="generateTab" class="tab-content">
            <div class="preview-section">
                <div class="preview-header">
                    <h2><i class="fas fa-code"></i> Data JavaScript</h2>
                    <button id="copyScriptButton" class="copy-button">
                        <i class="far fa-copy"></i> Salin Script
                    </button>
                </div>
                <div class="code-container">
                    <div id="codeBlock" class="code-block">
                        <pre><code id="generatedCode">const itemsData = [
    // Addons will appear here...
];</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="notification" class="notification"></div>

    <script>
        let itemsData = JSON.parse(localStorage.getItem('minepackAddons') || '[]');
        let currentEditIndex = null;

        const addonForm = document.getElementById('addonForm');
        const filesContainer = document.getElementById('filesContainer');
        const galleryContainer = document.getElementById('galleryContainer');
        const addFileButton = document.getElementById('addFileButton');
        const addGalleryButton = document.getElementById('addGalleryButton');
        const addonsContainer = document.getElementById('addonsContainer');
        const generatedCode = document.getElementById('generatedCode');
        const copyScriptButton = document.getElementById('copyScriptButton');
        const emptyState = document.getElementById('emptyState');
        const notification = document.getElementById('notification');
        const tabs = document.querySelectorAll('.tab-button');

        document.addEventListener('DOMContentLoaded', () => {
            setupEventListeners();
            renderAddonsList();
            updateGeneratedCode();
        });

        function setupEventListeners() {
            addonForm.addEventListener('submit', handleFormSubmit);
            
            addFileButton.addEventListener('click', () => addDynamicItem('file'));
            
            addGalleryButton.addEventListener('click', () => addDynamicItem('gallery'));
            
            copyScriptButton.addEventListener('click', copyGeneratedCode);
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => switchTab(tab.dataset.tab));
            });
        }

        function handleFormSubmit(e) {
            e.preventDefault();
            
            const addonData = {
                title: document.getElementById('addonTitle').value.trim(),
                category: document.getElementById('addonCategory').value,
                image: document.getElementById('addonImage').value.trim(),
                link: document.getElementById('addonLink').value.trim(),
                rating: parseFloat(document.getElementById('addonRating').value),
                downloads: parseInt(document.getElementById('addonDownloads').value),
                description: document.getElementById('addonDescription').value.trim(),
                files: [],
                gallery: []
            };
            
            document.querySelectorAll('#filesContainer .dynamic-item').forEach(item => {
                const name = item.querySelector('.fileName').value.trim();
                const size = item.querySelector('.fileSize').value.trim();
                if (name && size) {
                    addonData.files.push({ name, size });
                }
            });
            
            document.querySelectorAll('#galleryContainer .dynamic-item').forEach(item => {
                const url = item.querySelector('.galleryUrl').value.trim();
                if (url) {
                    addonData.gallery.push(url);
                }
            });
            
            if (!validateAddonData(addonData)) {
                return;
            }
            
            if (currentEditIndex !== null) {
                itemsData[currentEditIndex] = addonData;
                showNotification('Addon berhasil diperbarui!', 'success');
                currentEditIndex = null;
                addonForm.querySelector('.submit-button i').className = 'fas fa-save';
                addonForm.querySelector('.submit-button').innerHTML = '<i class="fas fa-save"></i> Simpan Addon';
            } else {
                itemsData.push(addonData);
                showNotification('Addon berhasil ditambahkan!', 'success');
            }
            
            localStorage.setItem('minepackAddons', JSON.stringify(itemsData));
            
            resetForm();
            renderAddonsList();
            updateGeneratedCode();
            
            switchTab('manage');
        }

        function validateAddonData(data) {
            if (!data.title) {
                showNotification('Nama addon tidak boleh kosong!', 'error');
                return false;
            }
            if (!data.category) {
                showNotification('Pilih kategori addon!', 'error');
                return false;
            }
            if (!data.image || !isValidUrl(data.image)) {
                showNotification('URL gambar tidak valid!', 'error');
                return false;
            }
            if (!data.link || !isValidUrl(data.link)) {
                showNotification('URL download tidak valid!', 'error');
                return false;
            }
            if (data.rating < 0 || data.rating > 5) {
                showNotification('Rating harus antara 0.0 - 5.0!', 'error');
                return false;
            }
            if (data.downloads < 0) {
                showNotification('Jumlah download tidak valid!', 'error');
                return false;
            }
            if (!data.description) {
                showNotification('Deskripsi tidak boleh kosong!', 'error');
                return false;
            }
            if (data.files.length === 0) {
                showNotification('Tambahkan minimal satu file!', 'error');
                return false;
            }
            if (data.gallery.length === 0) {
                showNotification('Tambahkan minimal satu gambar gallery!', 'error');
                return false;
            }
            return true;
        }

        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }

        function addDynamicItem(type) {
            const container = type === 'file' ? filesContainer : galleryContainer;
            const item = document.createElement('div');
            item.className = 'dynamic-item';
            
            if (type === 'file') {
                item.innerHTML = `
                    <input type="text" class="fileName" placeholder="Nama file" required>
                    <input type="text" class="fileSize" placeholder="Ukuran" required>
                    <button type="button" class="remove-button remove-file">
                        <i class="fas fa-minus"></i>
                    </button>
                `;
            } else {
                item.innerHTML = `
                    <input type="url" class="galleryUrl" placeholder="URL gambar gallery" required>
                    <button type="button" class="remove-button remove-gallery">
                        <i class="fas fa-minus"></i>
                    </button>
                `;
            }
            
            container.appendChild(item);
            
            const removeButton = item.querySelector('.remove-button');
            removeButton.addEventListener('click', () => {
                if (container.children.length > 1) {
                    item.remove();
                }
            });
        }

        function resetForm() {
            addonForm.reset();
            filesContainer.innerHTML = `
                <div class="dynamic-item">
                    <input type="text" class="fileName" placeholder="Nama file" required>
                    <input type="text" class="fileSize" placeholder="Ukuran" required>
                    <button type="button" class="remove-button remove-file"><i class="fas fa-minus"></i></button>
                </div>
            `;
            galleryContainer.innerHTML = `
                <div class="dynamic-item">
                    <input type="url" class="galleryUrl" placeholder="URL gambar gallery" required>
                    <button type="button" class="remove-button remove-gallery"><i class="fas fa-minus"></i></button>
                </div>
            `;
            currentEditIndex = null;
        }

        function renderAddonsList() {
            addonsContainer.innerHTML = '';
            
            if (itemsData.length === 0) {
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            itemsData.forEach((addon, index) => {
                const addonCard = createAddonCard(addon, index);
                addonsContainer.appendChild(addonCard);
            });
        }

        function createAddonCard(addon, index) {
            const card = document.createElement('div');
            card.className = 'addon-card';
            
            const formattedDownloads = addon.downloads.toLocaleString();
            
            const categoryNames = {
                maps: "World",
                addons: "Addon",
                mashups: "Mashup",
                textures: "Texture",
                skins: "Skin",
                modrinth: "Mod"
            };
            
            card.innerHTML = `
                <div class="addon-header">
                    <div class="addon-icon">
                        <img src="${addon.image}" alt="${addon.title}" onerror="this.src='https://via.placeholder.com/100x100/2c3e50/ecf0f1?text=No+Image'">
                    </div>
                    <div class="addon-info">
                        <div class="addon-title">${addon.title}</div>
                        <span class="addon-category">${categoryNames[addon.category] || addon.category}</span>
                    </div>
                </div>
                <div class="addon-stats">
                    <div class="addon-stat">
                        <i class="fas fa-star" style="color: gold;"></i>
                        <span>${addon.rating}</span>
                    </div>
                    <div class="addon-stat">
                        <i class="fas fa-download"></i>
                        <span>${formattedDownloads}</span>
                    </div>
                    <div class="addon-stat">
                        <i class="fas fa-file"></i>
                        <span>${addon.files.length} file</span>
                    </div>
                </div>
                <div class="addon-description">
                    ${addon.description.length > 100 ? addon.description.substring(0, 100) + '...' : addon.description}
                </div>
                <div class="addon-actions">
                    <button class="action-button edit-button edit-addon" data-index="${index}">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="action-button delete-button delete-addon" data-index="${index}">
                        <i class="fas fa-trash"></i> Hapus
                    </button>
                </div>
            `;
            
            const editButton = card.querySelector('.edit-addon');
            const deleteButton = card.querySelector('.delete-addon');
            
            editButton.addEventListener('click', () => editAddon(index));
            deleteButton.addEventListener('click', () => deleteAddon(index));
            
            return card;
        }

        function editAddon(index) {
            const addon = itemsData[index];
            currentEditIndex = index;
            
            document.getElementById('addonTitle').value = addon.title;
            document.getElementById('addonCategory').value = addon.category;
            document.getElementById('addonImage').value = addon.image;
            document.getElementById('addonLink').value = addon.link;
            document.getElementById('addonRating').value = addon.rating;
            document.getElementById('addonDownloads').value = addon.downloads;
            document.getElementById('addonDescription').value = addon.description;
            
            filesContainer.innerHTML = '';
            addon.files.forEach(file => {
                const fileItem = document.createElement('div');
                fileItem.className = 'dynamic-item';
                fileItem.innerHTML = `
                    <input type="text" class="fileName" value="${file.name}" required>
                    <input type="text" class="fileSize" value="${file.size}" required>
                    <button type="button" class="remove-button remove-file"><i class="fas fa-minus"></i></button>
                `;
                filesContainer.appendChild(fileItem);
            });
            
            galleryContainer.innerHTML = '';
            addon.gallery.forEach(url => {
                const galleryItem = document.createElement('div');
                galleryItem.className = 'dynamic-item';
                galleryItem.innerHTML = `
                    <input type="url" class="galleryUrl" value="${url}" required>
                    <button type="button" class="remove-button remove-gallery"><i class="fas fa-minus"></i></button>
                `;
                galleryContainer.appendChild(galleryItem);
            });
            
            const submitButton = addonForm.querySelector('.submit-button');
            submitButton.innerHTML = '<i class="fas fa-sync-alt"></i> Update Addon';
            
            switchTab('upload');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function deleteAddon(index) {
            if (confirm('Apakah Anda yakin ingin menghapus addon ini?')) {
                itemsData.splice(index, 1);
                localStorage.setItem('minepackAddons', JSON.stringify(itemsData));
                renderAddonsList();
                updateGeneratedCode();
                showNotification('Addon berhasil dihapus!', 'success');
            }
        }

        function updateGeneratedCode() {
            if (itemsData.length === 0) {
                generatedCode.textContent = `const itemsData = [
    // Addons will appear here...
];`;
                return;
            }
            
            let code = 'const itemsData = [\n';
            
            itemsData.forEach((addon, index) => {
                code += '    {\n';
                code += `        title: "${escapeString(addon.title)}",\n`;
                code += `        category: "${addon.category}",\n`;
                code += `        image: "${escapeString(addon.image)}",\n`;
                code += `        link: "${escapeString(addon.link)}",\n`;
                code += `        rating: ${addon.rating},\n`;
                code += `        downloads: ${formatDownloads(addon.downloads)},\n`;
                code += `        description: "${escapeString(addon.description)}",\n`;
                
                code += '        files: [\n';
                addon.files.forEach(file => {
                    code += `            { name: "${escapeString(file.name)}", size: "${escapeString(file.size)}" }`;
                    if (addon.files.indexOf(file) < addon.files.length - 1) code += ',';
                    code += '\n';
                });
                code += '        ],\n';
                
                code += '        gallery: [\n';
                addon.gallery.forEach((url, i) => {
                    code += `            "${escapeString(url)}"`;
                    if (i < addon.gallery.length - 1) code += ',';
                    code += '\n';
                });
                code += '        ]\n';
                
                code += '    }';
                if (index < itemsData.length - 1) code += ',';
                code += '\n';
            });
            
            code += '];';
            
            generatedCode.textContent = code;
        }

        function escapeString(str) {
            return str.replace(/"/g, '\\"').replace(/\n/g, '\\n');
        }

        function formatDownloads(downloads) {
            if (typeof downloads === 'number') {
                return downloads;
            }
            
            return `"${downloads}"`;
        }

        function copyGeneratedCode() {
            const codeText = generatedCode.textContent;
            
            navigator.clipboard.writeText(codeText).then(() => {
                copyScriptButton.innerHTML = '<i class="fas fa-check"></i> Tersalin!';
                copyScriptButton.classList.add('copied');
                showNotification('Script berhasil disalin ke clipboard!', 'success');
                
                setTimeout(() => {
                    copyScriptButton.innerHTML = '<i class="far fa-copy"></i>';
                    copyScriptButton.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy: ', err);
                showNotification('Gagal menyalin script!', 'error');
            });
        }

        function switchTab(tabName) {
            tabs.forEach(tab => {
                if (tab.dataset.tab === tabName) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            document.querySelectorAll('.tab-content').forEach(content => {
                if (content.id === tabName + 'Tab') {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
            
            if (tabName === 'generate') {
                updateGeneratedCode();
            }
        }

        function showNotification(message, type = 'info') {
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('remove-file') || 
                e.target.classList.contains('remove-gallery')) {
                const button = e.target.closest('.remove-button');
                const container = button.closest('.dynamic-list');
                const item = button.closest('.dynamic-item');
                
                if (container.children.length > 1) {
                    item.remove();
                }
            }
        });
    </script>
</body>
</html>
